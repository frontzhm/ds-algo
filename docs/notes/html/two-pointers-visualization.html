<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>åŒæŒ‡é’ˆå‰ªæå¯è§†åŒ– - åŠ¨æ€æ¼”ç¤º</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        padding: 20px;
      }

      .container {
        max-width: 1400px;
        margin: 0 auto;
        background: white;
        border-radius: 20px;
        padding: 30px;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
      }

      h1 {
        text-align: center;
        color: #333;
        margin-bottom: 10px;
        font-size: 2.5em;
      }

      .subtitle {
        text-align: center;
        color: #666;
        margin-bottom: 30px;
        font-size: 1.1em;
      }

      .problem-selector {
        display: flex;
        gap: 15px;
        justify-content: center;
        margin-bottom: 30px;
      }

      .problem-btn {
        padding: 12px 24px;
        border: 2px solid #667eea;
        background: white;
        color: #667eea;
        border-radius: 8px;
        cursor: pointer;
        font-size: 16px;
        transition: all 0.3s;
      }

      .problem-btn:hover {
        background: #667eea;
        color: white;
      }

      .problem-btn.active {
        background: #667eea;
        color: white;
      }

      .info-panel {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 20px;
        margin-bottom: 30px;
      }

      .info-card {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 20px;
        border-radius: 12px;
        text-align: center;
      }

      .info-card h3 {
        font-size: 14px;
        opacity: 0.9;
        margin-bottom: 10px;
      }

      .info-card .value {
        font-size: 32px;
        font-weight: bold;
      }

      .info-card .label {
        font-size: 12px;
        opacity: 0.8;
        margin-top: 5px;
      }

      .matrix-container {
        overflow-x: auto;
        margin-bottom: 30px;
        background: #f8f9fa;
        padding: 20px;
        border-radius: 12px;
      }

      .matrix {
        display: inline-block;
        border-collapse: collapse;
        margin: 0 auto;
      }

      .matrix th,
      .matrix td {
        padding: 12px 16px;
        text-align: center;
        border: 1px solid #ddd;
        min-width: 50px;
        font-size: 14px;
      }

      .matrix th {
        background: #667eea;
        color: white;
        font-weight: bold;
      }

      .matrix th:first-child {
        background: #764ba2;
      }

      .matrix td {
        background: white;
        transition: all 0.3s;
      }

      .matrix td.empty {
        background: #f0f0f0;
        color: #999;
      }

      .matrix td.current {
        background: #ffd700 !important;
        color: #333;
        font-weight: bold;
        animation: pulse 1s infinite;
      }

      .matrix td.pruned {
        background: #ff6b6b !important;
        color: white;
        text-decoration: line-through;
        opacity: 0.6;
      }

      .matrix td.checked {
        background: #51cf66 !important;
        color: white;
      }

      @keyframes pulse {
        0%,
        100% {
          transform: scale(1);
        }
        50% {
          transform: scale(1.1);
        }
      }

      .controls {
        display: flex;
        gap: 15px;
        justify-content: center;
        margin-bottom: 30px;
      }

      .btn {
        padding: 12px 30px;
        border: none;
        border-radius: 8px;
        font-size: 16px;
        cursor: pointer;
        transition: all 0.3s;
        font-weight: bold;
      }

      .btn-primary {
        background: #667eea;
        color: white;
      }

      .btn-primary:hover {
        background: #5568d3;
        transform: translateY(-2px);
        box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
      }

      .btn-secondary {
        background: #6c757d;
        color: white;
      }

      .btn-secondary:hover {
        background: #5a6268;
      }

      .btn:disabled {
        opacity: 0.5;
        cursor: not-allowed;
      }

      .explanation {
        background: #e7f3ff;
        border-left: 4px solid #667eea;
        padding: 20px;
        border-radius: 8px;
        margin-top: 20px;
      }

      .explanation h3 {
        color: #667eea;
        margin-bottom: 10px;
      }

      .explanation p {
        color: #333;
        line-height: 1.6;
        margin-bottom: 10px;
      }

      .pointer-info {
        display: flex;
        gap: 30px;
        justify-content: center;
        margin-bottom: 20px;
        font-size: 18px;
      }

      .pointer-info span {
        padding: 10px 20px;
        background: #f0f0f0;
        border-radius: 8px;
        font-weight: bold;
      }

      .pointer-info .left {
        color: #51cf66;
      }

      .pointer-info .right {
        color: #ff6b6b;
      }

      .step-counter {
        text-align: center;
        font-size: 18px;
        color: #666;
        margin-bottom: 20px;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>ğŸ¯ åŒæŒ‡é’ˆå‰ªæå¯è§†åŒ–</h1>
      <p class="subtitle">åŠ¨æ€æ¼”ç¤ºï¼šä» O(nÂ²) ä¼˜åŒ–åˆ° O(n) çš„å‰ªæè¿‡ç¨‹</p>

      <div class="problem-selector">
        <button class="problem-btn active" onclick="switchProblem('twoSum')">ä¸¤æ•°ä¹‹å’Œ II</button>
        <button class="problem-btn" onclick="switchProblem('container')">ç››æœ€å¤šæ°´çš„å®¹å™¨</button>
      </div>

      <div class="info-panel">
        <div class="info-card">
          <h3>åˆå§‹ç»„åˆæ•°</h3>
          <div class="value" id="totalCombinations">0</div>
          <div class="label">O(nÂ²)</div>
        </div>
        <div class="info-card">
          <h3>å‰©ä½™ç»„åˆæ•°</h3>
          <div class="value" id="remainingCombinations">0</div>
          <div class="label" id="remainingLabel">å¾…æ£€æŸ¥</div>
        </div>
        <div class="info-card">
          <h3>å·²æ£€æŸ¥ç»„åˆ</h3>
          <div class="value" id="checkedCombinations">0</div>
          <div class="label">å½“å‰è¿›åº¦</div>
        </div>
        <div class="info-card">
          <h3>æ—¶é—´å¤æ‚åº¦</h3>
          <div class="value" id="timeComplexity">O(nÂ²)</div>
          <div class="label" id="timeLabel">ä¼˜åŒ–ä¸­...</div>
        </div>
      </div>

      <div class="step-counter">
        <span>æ­¥éª¤ï¼š<strong id="stepCount">0</strong></span>
      </div>

      <div class="pointer-info">
        <span class="left">å·¦æŒ‡é’ˆ (left): <strong id="leftPointer">0</strong></span>
        <span class="right">å³æŒ‡é’ˆ (right): <strong id="rightPointer">0</strong></span>
      </div>

      <div class="matrix-container">
        <table class="matrix" id="matrix"></table>
      </div>

      <div class="controls">
        <button class="btn btn-primary" onclick="nextStep()">ä¸‹ä¸€æ­¥ â–¶</button>
        <button class="btn btn-secondary" onclick="reset()">é‡ç½® ğŸ”„</button>
        <button class="btn btn-secondary" onclick="autoPlay()">è‡ªåŠ¨æ’­æ”¾ â¯</button>
      </div>

      <div class="explanation" id="explanation">
        <h3>ğŸ’¡ è¯´æ˜</h3>
        <p id="explanationText">ç‚¹å‡»"ä¸‹ä¸€æ­¥"å¼€å§‹æ¼”ç¤ºåŒæŒ‡é’ˆçš„å‰ªæè¿‡ç¨‹</p>
      </div>
    </div>

    <script>
      let currentProblem = 'twoSum';
      let state = {
        left: 0,
        right: 0,
        step: 0,
        checked: new Set(),
        pruned: new Set(),
        data: [],
        target: 0,
        found: false,
      };

      const problems = {
        twoSum: {
          name: 'ä¸¤æ•°ä¹‹å’Œ II',
          data: [2, 7, 11, 15],
          target: 9,
          getValue: (left, right) => state.data[left] + state.data[right],
          shouldMoveLeft: (left, right) => {
            const sum = state.data[left] + state.data[right];
            return sum < state.target;
          },
          shouldMoveRight: (left, right) => {
            const sum = state.data[left] + state.data[right];
            return sum > state.target;
          },
          isFound: (left, right) => {
            return state.data[left] + state.data[right] === state.target;
          },
          getExplanation: (left, right, action) => {
            const sum = state.data[left] + state.data[right];
            if (action === 'moveLeft') {
              return `å½“å‰å’Œ = ${state.data[left]} + ${state.data[right]} = ${sum} < ${state.target}ï¼Œéœ€è¦å¢å¤§å’Œã€‚ç§»åŠ¨å·¦æŒ‡é’ˆï¼Œå‰ªæ‰ç¬¬ ${left} è¡Œçš„æ‰€æœ‰å‰©ä½™ç»„åˆã€‚`;
            } else if (action === 'moveRight') {
              return `å½“å‰å’Œ = ${state.data[left]} + ${state.data[right]} = ${sum} > ${state.target}ï¼Œéœ€è¦å‡å°å’Œã€‚ç§»åŠ¨å³æŒ‡é’ˆï¼Œå‰ªæ‰ç¬¬ ${right} åˆ—çš„æ‰€æœ‰å‰©ä½™ç»„åˆã€‚`;
            } else if (action === 'found') {
              return `æ‰¾åˆ°ç­”æ¡ˆï¼${state.data[left]} + ${state.data[right]} = ${sum} = ${state.target}`;
            }
            return '';
          },
        },
        container: {
          name: 'ç››æœ€å¤šæ°´çš„å®¹å™¨',
          data: [1, 8, 6, 2, 5, 4, 8, 3, 7],
          target: 0,
          getValue: (left, right) => {
            const width = right - left;
            const height = Math.min(state.data[left], state.data[right]);
            return width * height;
          },
          shouldMoveLeft: (left, right) => {
            return state.data[left] < state.data[right];
          },
          shouldMoveRight: (left, right) => {
            // å½“é«˜åº¦ç›¸ç­‰æ—¶ï¼Œç§»åŠ¨å³æŒ‡é’ˆï¼ˆæˆ–å·¦æŒ‡é’ˆéƒ½å¯ä»¥ï¼‰
            return state.data[left] >= state.data[right];
          },
          isFound: (left, right) => false,
          getExplanation: (left, right, action) => {
            const area = (right - left) * Math.min(state.data[left], state.data[right]);
            if (action === 'moveLeft') {
              return `å½“å‰é¢ç§¯ = (${right} - ${left}) Ã— min(${state.data[left]}, ${state.data[right]}) = ${area}ã€‚height[${left}] = ${state.data[left]} < height[${right}] = ${state.data[right]}ï¼Œç§»åŠ¨å·¦æŒ‡é’ˆï¼Œå‰ªæ‰ç¬¬ ${left} è¡Œçš„æ‰€æœ‰å‰©ä½™ç»„åˆã€‚`;
            } else if (action === 'moveRight') {
              const heightLeft = state.data[left];
              const heightRight = state.data[right];
              if (heightLeft === heightRight) {
                return `å½“å‰é¢ç§¯ = (${right} - ${left}) Ã— min(${heightLeft}, ${heightRight}) = ${area}ã€‚height[${left}] = ${heightLeft} = height[${right}] = ${heightRight}ï¼ˆé«˜åº¦ç›¸ç­‰ï¼‰ï¼Œç§»åŠ¨å³æŒ‡é’ˆï¼Œå‰ªæ‰ç¬¬ ${right} åˆ—çš„æ‰€æœ‰å‰©ä½™ç»„åˆã€‚`;
              } else {
                return `å½“å‰é¢ç§¯ = (${right} - ${left}) Ã— min(${heightLeft}, ${heightRight}) = ${area}ã€‚height[${left}] = ${heightLeft} > height[${right}] = ${heightRight}ï¼Œç§»åŠ¨å³æŒ‡é’ˆï¼Œå‰ªæ‰ç¬¬ ${right} åˆ—çš„æ‰€æœ‰å‰©ä½™ç»„åˆã€‚`;
              }
            }
            return '';
          },
        },
      };

      function switchProblem(problemName) {
        currentProblem = problemName;
        document.querySelectorAll('.problem-btn').forEach(btn => {
          btn.classList.remove('active');
        });
        event.target.classList.add('active');
        reset();
      }

      function init() {
        const problem = problems[currentProblem];
        state.data = [...problem.data];
        state.target = problem.target;
        state.left = 0;
        state.right = state.data.length - 1;
        state.step = 0;
        state.checked = new Set();
        state.pruned = new Set();
        state.found = false;

        createMatrix();
        updateInfo();
        updateExplanation('ç‚¹å‡»"ä¸‹ä¸€æ­¥"å¼€å§‹æ¼”ç¤ºåŒæŒ‡é’ˆçš„å‰ªæè¿‡ç¨‹');
      }

      function createMatrix() {
        const matrix = document.getElementById('matrix');
        matrix.innerHTML = '';

        const n = state.data.length;

        // åˆ›å»ºè¡¨å¤´
        const headerRow = document.createElement('tr');
        const emptyCell = document.createElement('th');
        emptyCell.textContent = 'i\\j';
        headerRow.appendChild(emptyCell);

        for (let j = 0; j < n; j++) {
          const th = document.createElement('th');
          th.textContent = j;
          headerRow.appendChild(th);
        }
        matrix.appendChild(headerRow);

        // åˆ›å»ºæ•°æ®è¡Œ
        for (let i = 0; i < n; i++) {
          const row = document.createElement('tr');
          const indexCell = document.createElement('th');
          indexCell.textContent = i;
          row.appendChild(indexCell);

          for (let j = 0; j < n; j++) {
            const cell = document.createElement('td');
            if (i >= j) {
              cell.textContent = '-';
              cell.classList.add('empty');
            } else {
              const key = `${i},${j}`;
              cell.textContent = key;
              cell.id = `cell-${i}-${j}`;
              cell.dataset.i = i;
              cell.dataset.j = j;
            }
            row.appendChild(cell);
          }
          matrix.appendChild(row);
        }

        // è®¡ç®—æ€»ç»„åˆæ•°
        const total = (n * (n - 1)) / 2;
        document.getElementById('totalCombinations').textContent = total;
      }

      function updateInfo() {
        const n = state.data.length;
        const total = (n * (n - 1)) / 2;
        const remaining = total - state.checked.size - state.pruned.size;
        const checked = state.checked.size;

        document.getElementById('remainingCombinations').textContent = remaining;
        document.getElementById('checkedCombinations').textContent = checked;
        document.getElementById('stepCount').textContent = state.step;
        document.getElementById('leftPointer').textContent = state.left;
        document.getElementById('rightPointer').textContent = state.right;

        // æ›´æ–°æ—¶é—´å¤æ‚åº¦æ˜¾ç¤º
        if (remaining <= state.data.length) {
          document.getElementById('timeComplexity').textContent = 'O(n)';
          document.getElementById('timeLabel').textContent = 'ä¼˜åŒ–å®Œæˆï¼';
        } else {
          const ratio = ((remaining / total) * 100).toFixed(1);
          document.getElementById('timeComplexity').textContent = `O(nÂ²) â†’ O(n)`;
          document.getElementById('timeLabel').textContent = `å·²ä¼˜åŒ– ${(100 - ratio).toFixed(1)}%`;
        }
      }

      function nextStep() {
        if (state.found || state.left >= state.right) {
          updateExplanation('ç®—æ³•å·²å®Œæˆï¼æ‰€æœ‰å¯èƒ½çš„ç»„åˆéƒ½å·²æ£€æŸ¥æˆ–å‰ªæã€‚');
          return;
        }

        const problem = problems[currentProblem];
        state.step++;

        // æ ‡è®°å½“å‰æ£€æŸ¥çš„ç»„åˆ
        const currentKey = `${state.left},${state.right}`;
        state.checked.add(currentKey);
        const currentCell = document.getElementById(`cell-${state.left}-${state.right}`);
        if (currentCell) {
          currentCell.classList.add('current');
          setTimeout(() => {
            currentCell.classList.remove('current');
            currentCell.classList.add('checked');
          }, 500);
        }

        // æ£€æŸ¥æ˜¯å¦æ‰¾åˆ°ç­”æ¡ˆ
        if (problem.isFound(state.left, state.right)) {
          state.found = true;
          updateExplanation(problem.getExplanation(state.left, state.right, 'found'));
          updateInfo();
          return;
        }

        // å†³å®šç§»åŠ¨å“ªä¸ªæŒ‡é’ˆ
        let action = '';
        const oldLeft = state.left;
        const oldRight = state.right;

        if (problem.shouldMoveLeft(state.left, state.right)) {
          // å‰ªæ‰ç¬¬ left è¡Œçš„æ‰€æœ‰å‰©ä½™ç»„åˆ
          for (let j = state.left + 1; j < state.right; j++) {
            const key = `${state.left},${j}`;
            state.pruned.add(key);
            const cell = document.getElementById(`cell-${state.left}-${j}`);
            if (cell) {
              cell.classList.add('pruned');
            }
          }
          state.left++;
          action = 'moveLeft';
        } else if (problem.shouldMoveRight(state.left, state.right)) {
          // å‰ªæ‰ç¬¬ right åˆ—çš„æ‰€æœ‰å‰©ä½™ç»„åˆ
          for (let i = state.left + 1; i < state.right; i++) {
            const key = `${i},${state.right}`;
            state.pruned.add(key);
            const cell = document.getElementById(`cell-${i}-${state.right}`);
            if (cell) {
              cell.classList.add('pruned');
            }
          }
          state.right--;
          action = 'moveRight';
        } else {
          // å¦‚æœæ²¡æœ‰åŒ¹é…ä»»ä½•æ¡ä»¶ï¼Œè¯´æ˜ç®—æ³•å·²å®Œæˆ
          updateExplanation('ç®—æ³•å·²å®Œæˆï¼æ‰€æœ‰å¯èƒ½çš„ç»„åˆéƒ½å·²æ£€æŸ¥æˆ–å‰ªæã€‚');
          updateInfo();
          return;
        }

        updateExplanation(problem.getExplanation(oldLeft, oldRight, action));
        updateInfo();
      }

      function reset() {
        init();
      }

      let autoPlayInterval = null;

      function autoPlay() {
        if (autoPlayInterval) {
          clearInterval(autoPlayInterval);
          autoPlayInterval = null;
          document.querySelector('.btn-secondary:last-child').textContent = 'è‡ªåŠ¨æ’­æ”¾ â¯';
          return;
        }

        document.querySelector('.btn-secondary:last-child').textContent = 'æš‚åœ â¸';
        autoPlayInterval = setInterval(() => {
          if (state.found || state.left >= state.right) {
            clearInterval(autoPlayInterval);
            autoPlayInterval = null;
            document.querySelector('.btn-secondary:last-child').textContent = 'è‡ªåŠ¨æ’­æ”¾ â¯';
            return;
          }
          nextStep();
        }, 1500);
      }

      function updateExplanation(text) {
        document.getElementById('explanationText').textContent = text;
      }

      // åˆå§‹åŒ–
      init();
    </script>
  </body>
</html>
